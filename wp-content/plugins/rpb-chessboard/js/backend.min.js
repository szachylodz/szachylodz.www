var RPBChessboard={};(function(e,t){"use strict";function it(e){if(typeof e=="boolean")return e;if(typeof e!="string")return N;switch(e.toLowerCase()){case"true":case"yes":case"1":return P;case"false":case"no":case"0":return k;default:return N}}function lt(e,n,r){ot<st[I]&&(st=st.slice(0,ot)),st.push({callback:e,undoValue:n,redoValue:r}),++ot,t(u)[p](_),t(a)[p](A)}function ct(){st=[],ot=0,t(u)[p](A),t(a)[p](A)}function ht(){if(ot===0)return;--ot,dt(st[ot][F],st[ot].undoValue),t(u)[p](ot===0?A:_),t(a)[p](_)}function pt(){if(ot===st[I])return;dt(st[ot][F],st[ot].redoValue),++ot,t(u)[p](_),t(a)[p](ot===st[I]?A:_)}function dt(e,t){ut=P,e(t),ut=k}function vt(e){var n=t(l),i=n[r](f,L);t(M+i)[H](h,k)[p](U),typeof e=="undefined"||e===i?n[r](f,L,V):(n[r](f,L,e),t(M+e)[H](h,P)[p](U))}function mt(e){var n=t(l);n[r](f,G,e),t("#rpbchessboard-editFENDialog-turn-"+n[r]("turn"))[H](h,P),t(E)[p](U),t("#rpbchessboard-editFENDialog-castle-wk")[H](h,n[r](y,"w","k")),t("#rpbchessboard-editFENDialog-castle-wq")[H](h,n[r](y,"w","q")),t("#rpbchessboard-editFENDialog-castle-bk")[H](h,n[r](y,"b","k")),t("#rpbchessboard-editFENDialog-castle-bq")[H](h,n[r](y,"b","q"));var i=n[r](R);t("#rpbchessboard-editFENDialog-enPassant-"+(i==="-"?D:"enabled"))[H](h,P),t(c)[H](D,i==="-"),i!=="-"&&t(c).val(i)}function gt(n,i,s){ut=P;var o=t(l);mt(n);if(typeof s===W&&s!==N){var u=O in s?it(s[O]):N;u===N&&(u=k),o[r](f,O,u),t(d)[H](h,u),o[r](f,m,"csl"in s?s.csl:""),o[r](f,g,"cal"in s?s.cal:"")}else o[r](f,m,""),o[r](f,g,"");vt(),ct(),t("#rpbchessboard-editFENDialog-submitButton")[p](f,"label",i?e[x].SUBMIT_BUTTON_ADD_LABEL:e[x].SUBMIT_BUTTON_EDIT_LABEL),ut=k}function yt(){if(t(v)[I]!==0)return;t("body").append('<div id="rpbchessboard-editFENDialog"><div class="rpbchessboard-columns"><div style="min-width:425px;">'+b+'<div class="rpbchessboard-toolbar uichess-chessboard-size30">'+'<div id="rpbchessboard-editFENDialog-addPiecesSelector" class="rpbchessboard-buttonSet">'+i+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-wp" name="interactionMode" value="addPieces-wp" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-wn" name="interactionMode" value="addPieces-wn" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-wb" name="interactionMode" value="addPieces-wb" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-wr" name="interactionMode" value="addPieces-wr" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-wq" name="interactionMode" value="addPieces-wq" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-wk" name="interactionMode" value="addPieces-wk" />'+'<label for="rpbchessboard-editFENDialog-addPieces-wp" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-w uichess-chessboard-piece-p"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-wn" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-w uichess-chessboard-piece-n"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-wb" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-w uichess-chessboard-piece-b"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-wr" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-w uichess-chessboard-piece-r"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-wq" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-w uichess-chessboard-piece-q"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-wk" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-w uichess-chessboard-piece-k"></div></label>'+n+i+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-bp" name="interactionMode" value="addPieces-bp" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-bn" name="interactionMode" value="addPieces-bn" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-bb" name="interactionMode" value="addPieces-bb" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-br" name="interactionMode" value="addPieces-br" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-bq" name="interactionMode" value="addPieces-bq" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addPieces-bk" name="interactionMode" value="addPieces-bk" />'+'<label for="rpbchessboard-editFENDialog-addPieces-bp" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-b uichess-chessboard-piece-p"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-bn" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-b uichess-chessboard-piece-n"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-bb" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-b uichess-chessboard-piece-b"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-br" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-b uichess-chessboard-piece-r"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-bq" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-b uichess-chessboard-piece-q"></div></label>'+'<label for="rpbchessboard-editFENDialog-addPieces-bk" class="rpbchessboard-graphicButton"><div class="uichess-chessboard-sized uichess-chessboard-color-b uichess-chessboard-piece-k"></div></label>'+n+n+'<div id="rpbchessboard-editFENDialog-turnSelector" class="rpbchessboard-buttonSet">'+i+'<input type="radio" id="rpbchessboard-editFENDialog-turn-w" name="turn" value="w" />'+'<label for="rpbchessboard-editFENDialog-turn-w" class="rpbchessboard-graphicButton">'+'<div class="uichess-chessboard-sized uichess-chessboard-color-w uichess-chessboard-turnFlag"></div>'+C+n+i+'<input type="radio" id="rpbchessboard-editFENDialog-turn-b" name="turn" value="b" />'+'<label for="rpbchessboard-editFENDialog-turn-b" class="rpbchessboard-graphicButton">'+'<div class="uichess-chessboard-sized uichess-chessboard-color-b uichess-chessboard-turnFlag"></div>'+C+n+n+'<div class="rpbchessboard-toolbarGroup">'+j+'<button id="rpbchessboard-editFENDialog-undo" class="rpbchessboard-graphicButton" title="'+e[x].UNDO_TOOLTIP+z+'<div class="rpbchessboard-undoIcon"></div>'+w+'<button id="rpbchessboard-editFENDialog-redo" class="rpbchessboard-graphicButton" title="'+e[x].REDO_TOOLTIP+z+'<div class="rpbchessboard-redoIcon"></div>'+w+n+'<div id="rpbchessboard-editFENDialog-flipSelector">'+'<input id="rpbchessboard-editFENDialog-flip" type="checkbox" />'+'<label for="rpbchessboard-editFENDialog-flip">'+e[x].FLIP_CHECKBOX_LABEL+C+n+n+n+n+'<div id="rpbchessboard-editFENDialog-chessboard"></div>'+n+'<div class="rpbchessboard-stretchable">'+b+'<div id="rpbchessboard-editFENDialog-accordion">'+K+e[x].STANDARD_POSITIONS_TAB_LABEL+X+j+'<div class="rpbchessboard-editFENDialog-buttonColumn">'+j+'<button id="rpbchessboard-editFENDialog-startPosition" class="rpbchessboard-graphicButton" title="'+e[x].START_POSITION_TOOLTIP+z+'<div class="rpbchessboard-startPositionIcon"></div>'+w+"</div><div>"+'<button id="rpbchessboard-editFENDialog-emptyPosition" class="rpbchessboard-graphicButton" title="'+e[x].EMPTY_POSITION_TOOLTIP+z+'<div class="rpbchessboard-emptyPositionIcon"></div>'+w+n+n+n+K+e[x].ANNOTATIONS_TAB_LABEL+X+j+o+e[x].SQUARE_MARKERS_SECTION_TITLE+n+s+T+'<div id="rpbchessboard-editFENDialog-addSquareMarkersSelector" class="rpbchessboard-buttonSet">'+i+'<input type="checkbox" id="rpbchessboard-editFENDialog-addSquareMarkers-G" name="interactionMode" value="addSquareMarkers-G" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addSquareMarkers-R" name="interactionMode" value="addSquareMarkers-R" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addSquareMarkers-Y" name="interactionMode" value="addSquareMarkers-Y" />'+'<label for="rpbchessboard-editFENDialog-addSquareMarkers-G" class="rpbchessboard-graphicButton"><div class="rpbchessboard-squareMarkerGreenIcon"></div></label>'+'<label for="rpbchessboard-editFENDialog-addSquareMarkers-R" class="rpbchessboard-graphicButton"><div class="rpbchessboard-squareMarkerRedIcon"></div></label>'+'<label for="rpbchessboard-editFENDialog-addSquareMarkers-Y" class="rpbchessboard-graphicButton"><div class="rpbchessboard-squareMarkerYellowIcon"></div></label>'+n+n+'<button id="rpbchessboard-editFENDialog-deleteSquareMarkers" class="rpbchessboard-graphicButton" title="'+e[x].DELETE_SQUARE_MARKERS_TOOLTIP+z+S+w+n+n+o+e[x].ARROW_MARKERS_SECTION_TITLE+n+s+T+'<div id="rpbchessboard-editFENDialog-addArrowMarkersSelector" class="rpbchessboard-buttonSet">'+i+'<input type="checkbox" id="rpbchessboard-editFENDialog-addArrowMarkers-G" name="interactionMode" value="addArrowMarkers-G" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addArrowMarkers-R" name="interactionMode" value="addArrowMarkers-R" />'+'<input type="checkbox" id="rpbchessboard-editFENDialog-addArrowMarkers-Y" name="interactionMode" value="addArrowMarkers-Y" />'+'<label for="rpbchessboard-editFENDialog-addArrowMarkers-G" class="rpbchessboard-graphicButton"><div class="rpbchessboard-arrowMarkerGreenIcon"></div></label>'+'<label for="rpbchessboard-editFENDialog-addArrowMarkers-R" class="rpbchessboard-graphicButton"><div class="rpbchessboard-arrowMarkerRedIcon"></div></label>'+'<label for="rpbchessboard-editFENDialog-addArrowMarkers-Y" class="rpbchessboard-graphicButton"><div class="rpbchessboard-arrowMarkerYellowIcon"></div></label>'+n+n+'<button id="rpbchessboard-editFENDialog-deleteArrowMarkers" class="rpbchessboard-graphicButton" title="'+e[x].DELETE_ARROW_MARKERS_TOOLTIP+z+S+w+n+n+n+K+e[x].ADVANCED_TAB_LABEL+X+j+o+e[x].CASTLING_SECTION_TITLE+n+s+'<table id="rpbchessboard-editFENDialog-castleRights" class="uichess-chessboard-size28"><tbody>'+et+"<td></td>"+"<td>O-O-O</td>"+"<td>O-O</td>"+Y+et+'<td><span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-b uichess-chessboard-sized"></span></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-bq" type="checkbox" data-color="b" data-side="q" /></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-bk" type="checkbox" data-color="b" data-side="k" /></td>'+Y+et+'<td><span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-w uichess-chessboard-sized"></span></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-wq" type="checkbox" data-color="w" data-side="q" /></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-wk" type="checkbox" data-color="w" data-side="k" /></td>'+Y+"</tbody></table>"+n+o+e[x].EN_PASSANT_SECTION_TITLE+n+s+'<ul id="rpbchessboard-editFENDialog-enPassantRights">'+"<li>"+'<input id="rpbchessboard-editFENDialog-enPassant-disabled" type="radio" name="enPassant" />'+'<label for="rpbchessboard-editFENDialog-enPassant-disabled">'+e[x].EN_PASSANT_DISABLED_BUTTON_LABEL+C+"</li>"+"<li>"+'<input id="rpbchessboard-editFENDialog-enPassant-enabled" type="radio" name="enPassant" />'+'<label for="rpbchessboard-editFENDialog-enPassant-enabled">'+e[x].EN_PASSANT_ENABLED_BUTTON_LABEL.replace("%1$s",'</label><select id="rpbchessboard-editFENDialog-enPassant-column"><option value="a">a</option><option value="b">b</option><option value="c">c</option><option value="d">d</option><option value="e">e</option><option value="f">f</option><option value="g">g</option><option value="h">h</option></select><label for="rpbchessboard-editFENDialog-enPassant-enabled">')+C+"</li>"+"</ul>"+n+n+n+n+n+n+n);var L=t(l);L[r]({squareSize:40,interactionMode:V,positionChange:function(e,t){ut||lt(function(e){mt(e)},t[$],t[Q])},flipChange:function(e,n){ut||lt(function(e){L[r](f,O,e),t(d)[H](h,e)},n[$],n[Q])},squareMarkersChange:function(e,t){ut||lt(function(e){L[r](f,m,e)},t[$],t[Q])},arrowMarkersChange:function(e,t){ut||lt(function(e){L[r](f,g,e)},t[$],t[Q])}}),t("#rpbchessboard-editFENDialog-addPiecesSelector input")[p]().each(function(e,n){t(n)[q](function(){vt(t(n).val())})}),t("#rpbchessboard-editFENDialog-addSquareMarkersSelector input")[p]().each(function(e,n){t(n)[q](function(){vt(t(n).val())})}),t("#rpbchessboard-editFENDialog-addArrowMarkersSelector input")[p]().each(function(e,n){t(n)[q](function(){vt(t(n).val())})}),t("#rpbchessboard-editFENDialog-deleteSquareMarkers")[p]()[q](function(){L[r](f,m,"")}),t("#rpbchessboard-editFENDialog-deleteArrowMarkers")[p]()[q](function(){L[r](f,g,"")}),t(E)[p]().each(function(e,n){t(n)[q](function(){L[r]("turn",t(n).val())})}),t(d)[q](function(){L[r](f,O,t(this)[H](h))}),t(u)[p]()[q](function(){ht()}),t(a)[p]()[q](function(){pt()}),t("#rpbchessboard-editFENDialog-startPosition")[p]()[q](function(){mt("start")}),t("#rpbchessboard-editFENDialog-emptyPosition")[p]()[q](function(){mt("empty")}),t("#rpbchessboard-editFENDialog-castleRights input").each(function(e,n){t(n)[q](function(){L[r](y,t(n).data("color"),t(n).data("side"),t(n)[H](h))})});var A=t(c);t("#rpbchessboard-editFENDialog-enPassant-disabled")[q](function(){A[H](D,P),L[r](R,"-")}),t("#rpbchessboard-editFENDialog-enPassant-enabled")[q](function(){A[H](D,k),A.change()}),A.change(function(){L[r](R,A.val())}),t("#rpbchessboard-editFENDialog-accordion").accordion(),t(v).dialog({autoOpen:k,modal:P,dialogClass:"wp-dialog",title:e[x].EDIT_CHESS_DIAGRAM_DIALOG_TITLE,width:750,buttons:[{text:e[x].CANCEL_BUTTON_LABEL,click:function(){t(this).dialog("close")}},{"class":"button-primary",id:"rpbchessboard-editFENDialog-submitButton",text:"",click:function(){t(this).dialog("close"),at!==N&&(ft[O]=L[r](f,O),ft.csl=L[r](f,m),ft.cal=L[r](f,g),at(L[r](f,G),ft))}}]})}function bt(e,t,n){if(t>e[I])return-1;var r=e.substr(t).search(n);return r<0?-1:r+t}function wt(e,t,n){e=e.substr(0,t);var r=-1;while(P){var i=bt(e,r+1,n);if(i<0)break;r=i}return r}var n="</div>",r="chessboard",i='<div class="rpbchessboard-buttonRow">',s='<div class="rpbchessboard-editFENDialog-sectionContent">',o='<div class="rpbchessboard-editFENDialog-sectionTitle">',u="#rpbchessboard-editFENDialog-undo",a="#rpbchessboard-editFENDialog-redo",f="option",l="#rpbchessboard-editFENDialog-chessboard",c="#rpbchessboard-editFENDialog-enPassant-column",h="checked",p="button",d="#rpbchessboard-editFENDialog-flip",v="#rpbchessboard-editFENDialog",m="squareMarkers",g="arrowMarkers",y="castleRights",b='<div class="rpbchessboard-jQuery-enableSmoothness">',w="</button>",E="#rpbchessboard-editFENDialog-turnSelector input",S='<div class="rpbchessboard-deleteIcon"></div>',x="i18n",T='<div class="rpbchessboard-toolbar">',N=null,C="</label>",k=!1,L="interactionMode",A="disable",O="flip",M="#rpbchessboard-editFENDialog-",_="enable",D="disabled",P=!0,H="prop",B="parseWordPressShortcodeAttributes",j="<div>",F="callback",I="length",q="click",R="enPassant",U="refresh",z='">',W="object",X="</h3>",V="movePieces",$="oldValue",J="showCoordinates",K="<h3>",Q="newValue",G="position",Y="</tr>",Z="function",et="<tr>",tt="options",nt="FEN_SHORTCODE",rt="squareSize";e[x]={EDITOR_BUTTON_LABEL:r,EDIT_CHESS_DIAGRAM_DIALOG_TITLE:"Insert/edit a chess diagram",CANCEL_BUTTON_LABEL:"Cancel",SUBMIT_BUTTON_ADD_LABEL:"Add a new chess diagram",SUBMIT_BUTTON_EDIT_LABEL:"Update the chess diagram",UNDO_TOOLTIP:"Undo the last modification",REDO_TOOLTIP:"Re-do the last modification",FLIP_CHECKBOX_LABEL:"Flip board",STANDARD_POSITIONS_TAB_LABEL:"Standard positions",START_POSITION_TOOLTIP:"Set the initial position",EMPTY_POSITION_TOOLTIP:"Clear the chessboard",ANNOTATIONS_TAB_LABEL:"Annotations",SQUARE_MARKERS_SECTION_TITLE:"Square markers",DELETE_SQUARE_MARKERS_TOOLTIP:"Remove the square markers",ARROW_MARKERS_SECTION_TITLE:"Arrow markers",DELETE_ARROW_MARKERS_TOOLTIP:"Remove the arrow markers",ADVANCED_TAB_LABEL:"Advanced settings",CASTLING_SECTION_TITLE:"Castling rights",EN_PASSANT_SECTION_TITLE:"En passant",EN_PASSANT_DISABLED_BUTTON_LABEL:"Not possible",EN_PASSANT_ENABLED_BUTTON_LABEL:"Possible on column %1$s"},e.config={FEN_SHORTCODE:"fen"};var st=[],ot=0,ut=k,at=N,ft={};e.showEditFENDialog=function(e){yt(),typeof e===Z?(at=e,ft={},gt("start",P)):typeof e===W&&e!==N?(at=F in e&&typeof e[F]===Z?e[F]:N,ft=tt in e&&typeof e[tt]===W?e[tt]:{},gt(e.fen,k,ft)):(at=N,ft={}),t(v).dialog("open")},e[B]=function(e){var t={},n=/([a-zA-Z_0-9]+)=([^ \]]+)(?: |\])/g,r=N,i=function(e,t){return t.toUpperCase()};while((r=n.exec(e))!==N){var s=r[1].toLowerCase().replace(/_([a-z]?)/g,i);t[s]=r[2]}return t},e.serializeFENShortcodeContent=function(t,n){var r=e.config[nt],i="["+r;return O in n&&n[O]&&(i+=" flip=true"),"csl"in n&&n.csl!==""&&(i+=" csl="+n.csl),"cal"in n&&n.cal!==""&&(i+=" cal="+n.cal),rt in n&&(i+=" square_size="+n[rt]),J in n&&(i+=" show_coordinates="+n[J]),i+="]"+t+"[/"+r+"]",i},e.identifyFENShortcodeContent=function(t,n,r){var i=e.config[nt],s=3+i[I],o=new RegExp("\\[\\/"+i+"\\]","g"),u=bt(t,Math.max(0,n-s+1),o),a=new RegExp("\\["+i+"[^\\[\\]]*\\]","g"),f=u<0?-1:wt(t,u,a);if(f>=0&&u>=0&&f<=n&&r<=u+s){var l=t.substr(f).match(a)[0],c=l[I],h=t.substr(f+c,u-f-c);return{beginShortcode:f,endShortcode:u+s,fen:h,options:e[B](l)}}return N}})(RPBChessboard,jQuery);